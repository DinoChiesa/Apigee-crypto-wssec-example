<Javascript name="JS-Sign" timeLimit="200">
  <!--
    Notes:
    - Using expiry tells the runtime to add a wsu:Timestamp with a wsu:Expires child
    - key_identifier_type drives the format of KeyInfo in the output signed document
    - the meaning of the other elements should be easy to infer
  -->
  <Source>
    <![CDATA[
var unsigned = context.getVariable('request.content');
var signed = crypto.wsSecRsaSign(unsigned, {
  private_key: '{private.key.pem}',
  certificate: '{public.cert.pem}',
  key_identifier_type: '{desired_key_identifier_type}',
  signing_method: 'rsa-sha256',
  digest_method: 'sha256',
  expiry: '120s'
});
context.setVariable('signed_soap', signed);
  ]]>
  </Source>
</Javascript>
